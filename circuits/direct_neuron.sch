v {xschem version=2.9.9 file_version=1.2 }
G {}
K {}
V {}
S {}
E {}
N 1780 -800 1780 -770 { lab=#net1}
N 1360 -920 1360 -890 { lab=vdd}
N 1780 -740 1800 -740 { lab=vdd}
N 1780 -860 1800 -860 { lab=vdd}
N 1920 -860 1940 -860 { lab=vdd}
N 1920 -740 1940 -740 { lab=vdd}
N 1620 -920 1620 -890 { lab=vdd}
N 1780 -920 1780 -890 { lab=vdd}
N 1920 -920 1920 -890 { lab=vdd}
N 1600 -860 1620 -860 { lab=vdd}
N 1700 -860 1740 -860 { lab=#net1}
N 1700 -800 1780 -800 { lab=#net1}
N 1700 -860 1700 -800 { lab=#net1}
N 1600 -620 1620 -620 { lab=vdd}
N 1800 -860 1800 -740 { lab=vdd}
N 1940 -860 1940 -740 { lab=vdd}
N 1780 -830 1780 -800 { lab=#net1}
N 1920 -800 1920 -770 { lab=#net2}
N 1940 -920 1940 -860 { lab=vdd}
N 1800 -920 1800 -860 { lab=vdd}
N 1600 -920 1600 -860 { lab=vdd}
N 1620 -830 1620 -650 { lab=#net3}
N 1600 -860 1600 -620 { lab=vdd}
N 1620 -540 1620 -290 { lab=vmem}
N 1780 -560 1780 -470 { lab=Vna}
N 1920 -500 1920 -470 { lab=Vk}
N 1720 -740 1740 -740 { lab=vmem}
N 1720 -540 1720 -440 { lab=vmem}
N 1720 -440 1740 -440 { lab=vmem}
N 1860 -740 1880 -740 { lab=Vna}
N 1860 -560 1860 -440 { lab=Vna}
N 1860 -440 1880 -440 { lab=Vna}
N 1780 -560 1860 -560 { lab=Vna}
N 1660 -620 1780 -620 { lab=Vna}
N 1680 -500 1920 -500 { lab=Vk}
N 1680 -500 1680 -260 { lab=Vk}
N 1660 -260 1680 -260 { lab=Vk}
N 1780 -380 1780 -290 { lab=#net4}
N 1920 -410 1920 -290 { lab=#net5}
N 1600 -260 1620 -260 { lab=vss}
N 1600 -260 1600 -200 { lab=vss}
N 1780 -260 1800 -260 { lab=vss}
N 1800 -260 1800 -200 { lab=vss}
N 1920 -260 1940 -260 { lab=vss}
N 1940 -260 1940 -200 { lab=vss}
N 1920 -230 1920 -200 { lab=vss}
N 1780 -230 1780 -200 { lab=vss}
N 1620 -230 1620 -200 { lab=vss}
N 1400 -260 1420 -260 { lab=vrefr}
N 1420 -320 1420 -260 { lab=vrefr}
N 1860 -260 1880 -260 { lab=vrefr}
N 1860 -320 1860 -260 { lab=vrefr}
N 1360 -320 1360 -290 { lab=vrefr}
N 1660 -860 1700 -860 { lab=#net1}
N 1780 -620 1780 -560 { lab=Vna}
N 1860 -740 1860 -560 { lab=Vna}
N 1780 -710 1780 -620 { lab=Vna}
N 1920 -710 1920 -500 { lab=Vk}
N 1360 -320 1420 -320 { lab=vrefr}
N 1340 -260 1360 -260 { lab=vss}
N 1340 -260 1340 -200 { lab=vss}
N 1360 -230 1360 -200 { lab=vss}
N 1360 -830 1360 -320 { lab=vrefr}
N 1420 -320 1860 -320 { lab=vrefr}
N 1520 -540 1620 -540 { lab=vmem}
N 1620 -590 1620 -540 { lab=vmem}
N 2020 -500 2020 -470 { lab=Vk}
N 1920 -500 2020 -500 { lab=Vk}
N 2020 -410 2020 -200 { lab=vss}
N 1940 -200 2020 -200 { lab=vss}
N 1920 -920 1940 -920 { lab=vdd}
N 1520 -410 1520 -200 { lab=vss}
N 1520 -540 1520 -470 { lab=vmem}
N 1720 -260 1740 -260 { lab=#net4}
N 1720 -380 1720 -260 { lab=#net4}
N 1720 -380 1780 -380 { lab=#net4}
N 1600 -920 1620 -920 { lab=vdd}
N 1620 -920 1780 -920 { lab=vdd}
N 1800 -920 1920 -920 { lab=vdd}
N 1780 -920 1800 -920 { lab=vdd}
N 1780 -200 1800 -200 { lab=vss}
N 1920 -200 1940 -200 { lab=vss}
N 1800 -200 1920 -200 { lab=vss}
N 1620 -200 1780 -200 { lab=vss}
N 1600 -200 1620 -200 { lab=vss}
N 1340 -200 1360 -200 { lab=vss}
N 1780 -410 1780 -380 { lab=#net4}
N 1780 -440 1800 -440 { lab=vss}
N 1800 -440 1800 -260 { lab=vss}
N 1920 -440 1940 -440 { lab=vss}
N 1940 -440 1940 -260 { lab=vss}
N 1860 -860 1880 -860 { lab=#net2}
N 1860 -860 1860 -800 { lab=#net2}
N 1860 -800 1920 -800 { lab=#net2}
N 1620 -540 1720 -540 { lab=vmem}
N 1160 -920 1160 -890 { lab=vdd}
N 1160 -830 1160 -290 { lab=#net6}
N 1160 -230 1160 -200 { lab=vss}
N 1920 -830 1920 -800 { lab=#net2}
N 1720 -740 1720 -540 { lab=vmem}
N 570 -300 710 -300 { lab=0}
N 680 -320 710 -320 { lab=in}
N 570 -320 600 -320 { lab=vref}
N 940 -200 1160 -200 { lab=vss}
N 540 -200 740 -200 { lab=vss}
N 740 -250 740 -200 { lab=vss}
N 540 -250 540 -200 { lab=vss}
N 540 -470 540 -440 { lab=refbias}
N 540 -440 540 -370 { lab=refbias}
N 840 -920 840 -880 { lab=vdd}
N 540 -920 540 -530 { lab=vdd}
N 1520 -200 1600 -200 { lab=vss}
N 680 -480 700 -480 { lab=resbias}
N 540 -440 600 -440 { lab=refbias}
N 600 -520 600 -440 { lab=refbias}
N 600 -520 700 -520 { lab=refbias}
N 680 -480 680 -440 { lab=resbias}
N 680 -440 740 -440 { lab=resbias}
N 740 -470 740 -440 { lab=resbias}
N 740 -440 740 -370 { lab=resbias}
N 840 -920 1160 -920 { lab=vdd}
N 740 -780 740 -640 { lab=divin}
N 540 -920 840 -920 { lab=vdd}
N 740 -580 740 -530 { lab=#net7}
N 1520 -680 1520 -640 { lab=divout}
N 840 -780 840 -680 { lab=divout}
N 760 -780 760 -740 { lab=vss}
N 920 -740 940 -740 { lab=vss}
N 940 -740 940 -200 { lab=vss}
N 780 -780 780 -740 { lab=vss}
N 800 -780 800 -740 { lab=vss}
N 820 -780 820 -740 { lab=vss}
N 880 -780 880 -740 { lab=vss}
N 900 -780 900 -740 { lab=vss}
N 920 -780 920 -740 { lab=vss}
N 940 -780 940 -740 { lab=vss}
N 740 -200 940 -200 { lab=vss}
N 760 -740 780 -740 { lab=vss}
N 780 -740 800 -740 { lab=vss}
N 800 -740 820 -740 { lab=vss}
N 880 -740 900 -740 { lab=vss}
N 900 -740 920 -740 { lab=vss}
N 860 -780 860 -740 { lab=vss}
N 860 -740 880 -740 { lab=vss}
N 820 -740 860 -740 { lab=vss}
N 1520 -580 1520 -540 { lab=vmem}
N 1160 -200 1340 -200 { lab=vss}
N 1360 -200 1520 -200 { lab=vss}
N 1360 -920 1600 -920 { lab=vdd}
N 1160 -920 1360 -920 { lab=vdd}
N 840 -680 1520 -680 { lab=divout}
C {devices/code_shown.sym} 40 -800 0 0 {name=ngspice 
only_toplevel=true 
value=" 
.options gmin=1e-15 abstol=10f
.option savecurrents
vvss vss 0 0
vpref vref 0 60
Vin in vref dc 0 ac 0.25 sin(0 55 1)
.control
save all
op
write direct_neuron.op.raw
*dc vpressure 0.01 120 0.1
tran  10u 2 10u
write direct_neuron.raw
wrdata direct_neuron.spikes.csv vmem
wrdata direct_neuron.pressure.csv in
*plot -all.Vres/all.Vres#branch 
plot v(in)
plot Vmeas#branch
plot Vineuron#branch
plot Vmeas#branch/Vineuron#branch
plot vmem Vna Vk
*plot all.vdd_meas#branch*all.vdd
.endc
"}
C {devices/code.sym} 150 -260 0 0 {name=TT_MODELS
only_toplevel=true
format="tcleval( @value )"
value=".lib \\\\$::SKYWATER_MODELS\\\\/models/sky130.lib.spice tt

.param mc_mm_switch=0
.param mc_pr_switch=1

"}
C {devices/ammeter.sym} 740 -610 0 1 {name=Vmeas}
C {devices/ammeter.sym} 1160 -260 2 0 {name=vdd_meas}
C {devices/vsource.sym} 1160 -860 0 1 {name=V1 value="pwl(0 0 1u 1.2)"
}
C {sky130_fd_pr/nfet_01v8.sym} 1760 -260 0 0 {name=M2
L=2
W=2
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 1760 -440 0 0 {name=M3
L=2
W=2
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/cap_mim_m3_1.sym} 1520 -440 0 0 {name=C1 model=cap_mim_m3_1 W=10 L=10 MF=1 spiceprefix=X}
C {sky130_fd_pr/cap_mim_m3_1.sym} 2020 -440 0 0 {name=C2 model=cap_mim_m3_1 W=2 L=2 MF=1 spiceprefix=X}
C {sky130_fd_pr/nfet_01v8.sym} 1640 -260 0 1 {name=M14
L=5
W=0.5
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {devices/lab_pin.sym} 1780 -620 0 1 {name=l2 lab=Vna}
C {devices/lab_pin.sym} 1680 -500 0 0 {name=l6 lab=Vk}
C {sky130_fd_pr/nfet_01v8.sym} 1900 -260 0 0 {name=M4
L=2
W=2
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/nfet_01v8.sym} 1900 -440 0 0 {name=M5
L=2
W=2
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {devices/isource.sym} 1360 -860 0 1 {name=I3 value=0.01n

}
C {sky130_fd_pr/nfet_01v8.sym} 1380 -260 0 1 {name=M16
L=2
W=2
nf=1 
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=nfet_01v8
spiceprefix=X
}
C {devices/lab_pin.sym} 1360 -320 0 0 {name=l25 sig_type=std_logic lab=vrefr}
C {sky130_fd_pr/pfet_01v8.sym} 1760 -740 0 0 {name=M6
L=2
W=2
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1760 -860 0 0 {name=M7
L=2
W=4
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1900 -860 0 0 {name=M8
L=2
W=2
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1900 -740 0 0 {name=M9
L=2
W=2
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1640 -860 0 1 {name=M10
L=2
W=4
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {sky130_fd_pr/pfet_01v8.sym} 1640 -620 0 1 {name=M11
L=2
W=2
nf=1
mult=1
ad="'int((nf+1)/2) * W/nf * 0.29'" 
pd="'2*int((nf+1)/2) * (W/nf + 0.29)'"
as="'int((nf+2)/2) * W/nf * 0.29'" 
ps="'2*int((nf+2)/2) * (W/nf + 0.29)'"
nrd="'0.29 / W'" nrs="'0.29 / W'"
sa=0 sb=0 sd=0
model=pfet_01v8
spiceprefix=X
}
C {/home/cmaier/.xschem/sky130_TAC3/circuits/piezoresistor.sym} 830 -310 0 0 {name=x1}
C {/home/cmaier/.xschem/sky130_TAC3/circuits/piezoresistor.sym} 450 -310 0 1 {name=x2}
C {devices/lab_wire.sym} 630 -300 2 0 {name=l3 lab=0}
C {devices/lab_pin.sym} 680 -320 0 0 {name=l4 lab=in}
C {devices/lab_pin.sym} 600 -320 0 1 {name=l7 lab=vref}
C {devices/lab_pin.sym} 540 -400 0 0 {name=l8 lab=refbias}
C {devices/lab_pin.sym} 740 -400 0 0 {name=l9 lab=resbias}
C {devices/title.sym} 200 -80 0 0 {name=l10 author="Michele Mastella, Christoph Maier"}
C {devices/lab_wire.sym} 920 -920 0 0 {name=l11 lab=vdd}
C {devices/lab_wire.sym} 920 -200 0 0 {name=l12 lab=vss}
C {../playground/dividerchain.sym} 840 -840 0 0 {name=xdivider}
C {devices/ammeter.sym} 1520 -610 0 1 {name=Vineuron}
C {devices/isource.sym} 540 -500 0 1 {name=I1 value=300n}
C {devices/vcvs.sym} 740 -500 0 0 {name=E1 value=-10k}
C {devices/lab_pin.sym} 740 -710 0 0 {name=l1 lab=divin}
C {devices/lab_pin.sym} 840 -710 0 0 {name=l5 lab=divout}
C {devices/lab_pin.sym} 1720 -540 0 1 {name=l13 lab=vmem}
